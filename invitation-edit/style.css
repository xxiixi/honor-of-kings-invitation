:root {
    --bg-color: #1a1a1a;
    --card-red: #9e1a1a;
    --card-paper: #f0ebe5;
    --gold: #d4af37;
    --gold-light: #f3e5ab;
    --text-dark: #2c2c2c;
    --card-content-gold: #d4a509;
}

* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
    background-color: var(--bg-color);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    min-height: 100dvh;
    font-family: 'Noto Serif SC', serif;
    overflow: auto;
    perspective: 1800px;
}


/* 主容器 - PC 端固定尺寸，页面居中，不随窗口缩小被压缩 */
.card-container {
    position: relative;
    width: 380px;
    height: 660px;
    min-width: 350px;
    min-height: 660px;
    flex-shrink: 0;
    transform-style: preserve-3d;
    transition: transform 1s cubic-bezier(0.19, 1, 0.22, 1);
    cursor: pointer;
}

.card-container.open {
    transform: translateX(15%) rotateY(-5deg);
}

@media (max-width: 580px) {
    .card-container.open {
        transform: translateX(5%);
    }
}

/* 通用阴影 */
.shadow-soft { box-shadow: 0 10px 40px -10px rgba(0,0,0,0.5); }

/* ==================== 封面 (Cover) ==================== */
.cover-page {
    position: absolute;
    top: 0; left: 0; width: 100%; height: 100%;
    background-color: var(--card-red);
    background-image: linear-gradient(135deg, rgba(255,255,255,0.05) 0%, transparent 40%, rgba(0,0,0,0.1) 100%);
    border-radius: 0 4px 4px 0;
    z-index: 100;
    transform-origin: left center;
    transition: transform 1.2s cubic-bezier(0.645, 0.045, 0.355, 1);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    border-right: 1px solid rgba(0,0,0,0.2);
    margin-right: 10px;
}

.card-container.open .cover-page {
    transform: rotateY(-140deg);
    box-shadow: -5px 5px 20px rgba(0,0,0,0.2);
}

/* 封面设计元素 */

/* 1. 金色线条装饰 (Golden Circle Line) */
.circle-line {
    position: absolute;
    top: 35%; right: -30%;
    width: 90%; padding-bottom: 90%; /* 保持圆形 */
    border: 1px solid rgba(255, 236, 179, 0.3);
    border-radius: 50%;
}
.circle-line::after {
    content: ''; position: absolute; top: 15px; left: 15px; right: 15px; bottom: 15px;
    border: 1px solid rgba(255, 236, 179, 0.15); border-radius: 50%;
}

/* 2. 囍字 (印章风格) - 封面左上角 */
.xi-seal {
    position: absolute;
    top: 40px;
    left: 40px;
    /* font-family: 'Zhi Mang Xing', cursive; */
    font-weight: 900;
    font-size: 75px;
    color: rgba(158, 26, 26);
    background: rgba(243, 229, 171, 0.9);
    width: 100px; 
    height: 100px;
    display: flex; 
    justify-content: center; 
    align-items: center;
    border-radius: 8px;
    box-shadow: 4px 4px 15px rgba(0,0,0,0.2);
    z-index: 10;
}
.xi-seal::before {
    content: ''; position: absolute; top:0; left:0; width:100%; height:100%;
    background-image: radial-gradient(rgba(158, 26, 26, 0.2) 1px, transparent 1px);
    background-size: 4px 4px; opacity: 0.5;
    border-radius: inherit;
    pointer-events: none;
}

/* 3. 主标题 "请帖" (在圆环中) */
.title-main {
    position: absolute;
    top: 48%;
    left: 43%;
    transform: translate(-50%, -50%);
    font-family: 'Zhi Mang Xing', cursive;
    font-size: 100px;
    line-height: 1.2;
    color: rgba(255,255,255,0.1);
    pointer-events: none;
    z-index: 1;
}
/* 叠加一层清晰的金色 */
.title-main-overlay {
    position: absolute;
    top: 55%;
    left: 35%;
    transform: translate(-50%, -50%);
    font-family: 'Ma Shan Zheng', cursive;
    font-size: 85px;
    color: var(--gold-light);
    letter-spacing: 0.1em;
    text-shadow: 0 2px 10px rgba(0,0,0,0.3);
    text-align: center;
    z-index: 2;
}

.side-text-col {
    position: absolute;
    margin-top: 70px;
    margin-left: 20%;
    height: 60%;
    display: flex;
    align-items: center;
    z-index: 5;
}
.side-text {
    writing-mode: vertical-rl;
    text-orientation: upright;
    font-family: 'Noto Serif SC', serif;
    font-weight: 300; /* 细体 */
    font-size: 16px;
    color: rgba(255, 255, 255, 0.7);
    letter-spacing: 0.8em;
    white-space: nowrap;
    border-left: 1px solid rgba(255,255,255,0.3);
    padding-left: 12px;
}

.hint {
    position: absolute; bottom: 3vh; width: 100%; text-align: center;
    font-size: 10px; letter-spacing: 4px; color: rgba(255,255,255,0.4);
    text-transform: uppercase;
}

/* ==================== 内页 (Inside) ==================== */
.inside-page {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background-color: var(--card-paper);
    border-radius: 0 4px 4px 0;
    padding: 20px;
    display: flex; flex-direction: column;
    color: var(--text-dark);
    box-shadow: inset 0 0 40px rgba(0,0,0,0.05); /* 纸张内凹感 */
}

/* 内页边框 - 双线风格 */
.inner-frame {
    border: 3px double var(--card-red);
    height: 100%; width: 100%;
    padding: 40px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: space-between;
    gap: 0;
    position: relative;
}
.inner-frame-top {
    flex-shrink: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
}

/* 装饰角 */
.corner-deco {
    position: absolute; width: 20px; height: 20px;
    border: 2px solid var(--card-red); transition: all 0.3s;
}
.c-tl { top: -2px; left: -2px; border-right: none; border-bottom: none; }
.c-tr { top: -2px; right: -2px; border-left: none; border-bottom: none; }
.c-bl { bottom: -2px; left: -2px; border-right: none; border-top: none; }
.c-br { bottom: -2px; right: -2px; border-left: none; border-top: none; }

.header-xi {
    font-family: 'Ma Shan Zheng'; 
    font-size: 24px; 
    color: var(--card-red); 
    margin-bottom: 20px;
    text-shadow: 0 0 8px rgba(158, 26, 26, 0.6),
        0 0 12px rgba(158, 26, 26, 0.4);
    opacity: 0.8; 
    letter-spacing: 2px;
    display: flex;
    align-items: center;
    justify-content: center;
    /* gap: 8px; */
}
/* 喜事将近左右红灯笼 */
.header-xi .lantern {
    font-size: 24px;
    line-height: 1;
    vertical-align: middle;
}

.main-message {
    font-family: 'Ma Shan Zheng', cursive;
    font-size: 28px ;
    color: #2c2c2c;
    line-height: 1.3;
    text-align: center;
    margin-top: -10px;
    margin-bottom: 20px;
}

.invite-message {
    /* font-family: 'Ma Shan Zheng', cursive;  */
    font-size: 18px; 
    margin-bottom: 20px;
    opacity: 0.9; 
    letter-spacing: 2px;
}

.content-block {
    width: 100%;
    text-align: center;
    font-size: 17px;
    line-height: 1.8;
    font-weight: 600;
    margin-bottom: 3vh;
    color: #2a2a2a;
}
/* 国服对抗路 + 用户名样式 */
.content-block .rank-text {
    margin: 0 8px;
    color: var(--card-red);
    letter-spacing: 0.08em;
    font-weight: 900;
    text-shadow: 0 1px 0 rgba(0,0,0,0.12);
    border-bottom: 0.5px solid var(--card-red);
}
.content-block .username-text {
    display: inline-block;
    padding: 0 6px;
    margin-top: 15px;
    margin-bottom: 0px;
    color: rgb(12, 12, 12);
    font-weight: 900;
    letter-spacing: 0.06em;
    font-size: 1.2em;
}
.content-block .highlight-text {
    color: #555;
    font-weight: 900;
    text-decoration: underline;
    letter-spacing: 0.1em;
}
.content-block .invite-vertical {
    margin-top: 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
}
.content-block .invite-vertical p {
    width: 100%;
}
.content-block .venue-name {
    font-weight: 900;
    font-size: 1.2em;
    letter-spacing: 0.1em;
    text-shadow: 0 1px 2px rgba(0,0,0,0.2), 0 2px 6px rgba(0,0,0,0.15), 0 0 12px rgba(212, 175, 55, 0.25);
}
.content-block .glory-text {
    font-size: 1.2em;
    color: var(--card-red);
    font-weight: 900;
    letter-spacing: 0.15em;
    margin-bottom: -10px;
}

/* 信息票据卡 */
.ticket-info {
    background: #fff;
    width: 100%;
    border: 1px dashed #ccc;
    padding: 15px;
    position: relative;
    margin-bottom: 60px;
}
/* 票据左右的半圆缺口 */
.ticket-info::before, .ticket-info::after {
    content: ''; position: absolute; top: 50%; width: 12px; height: 12px;
    background: var(--card-paper); border-radius: 50%; transform: translateY(-50%);
}
.ticket-info::before { left: -6px; border-right: 1px solid #ccc; }
.ticket-info::after { right: -6px; border-left: 1px solid #ccc; }

.info-row {
    display: flex; margin-bottom: 8px; font-size: 14px; text-align: left;
}
.label { color: var(--card-red); font-weight: bold; width: 3em; flex-shrink: 0; }
.val { color: #333; }

/* ========== 核心修复：中式双边框印章 ========== */
.footer-stamp {
    position: absolute;
    bottom: 60px;
    right: 30px;
    width: 80px;
    height: 80px;
    min-width: 80px;
    min-height: 80px;
    flex-shrink: 0;
    /* 外层粗边框 */
    border: 1px solid var(--card-red);
    border-radius: 8px;
    /* 内边距：留出双边框的间距 */
    padding: 5px;
    /* 印章底色+中式纹理 */
    background-color: rgba(158, 26, 26, 0.08);
    background-image: 
        repeating-linear-gradient(45deg, rgba(158, 26, 26, 0.05) 0, rgba(158, 26, 26, 0.05) 2px, transparent 2px, transparent 10px),
        repeating-linear-gradient(-45deg, rgba(158, 26, 26, 0.05) 0, rgba(158, 26, 26, 0.05) 2px, transparent 2px, transparent 10px);
    background-size: 20px 20px;
    /* 基础布局 - 确保文字居中 */
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    /* 立体效果 */
    box-shadow: 3px 3px 10px rgba(158, 26, 26, 0.2);
    transform: rotate(-10deg);
    opacity: 0.95;
}

/* 内层细边框 + 文字容器 */
.footer-stamp .stamp-inner {
    width: 100%;
    height: 100%;
    flex-shrink: 0;
    /* 内层细边框 */
    border: 1px solid var(--card-red);
    border-radius: 4px;
    /* 文字样式 */
    color: var(--card-red);
    font-family: 'Ma Shan Zheng', cursive;
    font-size: 20px;
    font-weight: bold;
    letter-spacing: 4px;
    line-height: 1.1;
    /* 文字居中 - 使用 flexbox 确保完美居中 */
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    /* 确保文字不会溢出 */
    box-sizing: border-box;
}

/* 中式角标装饰 */
.footer-stamp::before, .footer-stamp::after {
    content: "✨";
    position: absolute;
    color: var(--card-red);
    font-size: 15px;
    opacity: 0.7;
    z-index: 1;
}
.footer-stamp::before {
    top: 8px;
    left: 8px;
}
.footer-stamp::after {
    bottom: 8px;
    right: 8px;
}

/* ==================== 可编辑版：布局与按钮 ==================== */
body.edit-mode {
    justify-content: center;
    align-items: center;
    perspective: none;
}
.edit-wrap {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 24px;
}
.edit-mode .card-container {
    flex-shrink: 0;
}

/* 可编辑版：封面与内页平铺，无翻页 */
.card-container--flat {
    display: flex;
    flex-direction: row;
    width: 760px;
    max-width: 100%;
    height: 660px;
    min-height: 660px;
    transform: none;
    cursor: default;
    transform-style: flat;
}
.card-container--flat .cover-page {
    position: relative;
    width: 380px;
    min-width: 380px;
    flex-shrink: 0;
    transform: none;
    border-radius: 4px 0 0 4px;
    border-right: 1px solid rgba(0,0,0,0.2);
}
.card-container--flat .cover-page .hint {
    display: none;
}
.card-container--flat .inside-page {
    position: relative;
    width: 380px;
    min-width: 380px;
    flex-shrink: 0;
    border-radius: 0 4px 4px 0;
}

@media (max-width: 780px) {
    .card-container--flat {
        flex-direction: column;
        width: 100%;
        max-width: 380px;
        height: auto;
        min-height: 0;
    }
    .card-container--flat .cover-page {
        width: 100%;
        min-width: 100%;
        height: 660px;
        border-radius: 4px 4px 0 0;
    }
    .card-container--flat .inside-page {
        width: 100%;
        min-width: 100%;
        min-height: 660px;
        border-radius: 0 0 4px 4px;
    }
}
.edit-actions {
    width: 100%;
    max-width: 380px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}
.btn-generate {
    width: 100%;
    padding: 12px 20px;
    font-size: 16px;
    font-family: inherit;
    color: var(--card-paper);
    background: var(--card-red);
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s, transform 0.1s;
}
.btn-generate:hover {
    background: #b51f1f;
}
.btn-generate:active {
    transform: scale(0.98);
}
.edit-url-output {
    width: 100%;
    min-height: 88px;
    padding: 14px 16px;
    font-size: 14px;
    font-family: inherit;
    line-height: 1.5;
    color: var(--text-dark);
    background: #f8f8f8;
    border: 1px solid #ddd;
    border-radius: 6px;
    resize: none;
}
.edit-url-output::placeholder {
    color: #999;
}
.btn-copy-all {
    width: 100%;
    padding: 12px 20px;
    font-size: 16px;
    font-family: inherit;
    color: var(--card-paper);
    background: var(--card-red);
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.2s, transform 0.1s;
}
.btn-copy-all:hover {
    background: #b51f1f;
}
.btn-copy-all:active {
    transform: scale(0.98);
}
.edit-mode [contenteditable="true"] {
    outline: 1px dashed rgba(212, 175, 55, 0.5);
    outline-offset: 2px;
    border-radius: 2px;
    min-height: 1.2em;
    display: inline-block;
    min-width: 1em;
}
.edit-mode [contenteditable="true"]:empty::before {
    content: "\200B";
}
.edit-mode [contenteditable="true"]:focus {
    outline-color: var(--gold);
}

/* 编辑模式：票据部分输入框固定宽度、不换行 */
.edit-mode .ticket-info .val {
    min-width: 0;
    flex: 1;
}
.edit-mode .ticket-info .date-sub,
.edit-mode .ticket-info .place-sub {
    margin-top: 0.25em;
}
.edit-mode .ticket-info [contenteditable="true"] {
    width: 100%;
    max-width: 100%;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    display: block;
}
